{
    "services": [
        {
            "name": "wisemapping",
            "image": "wisemapping/wisemapping:latest",
            "isMain": true,
            "internalPort": 80,
            "environment": {
                "TZ": "${TZ}",
                "JAVA_OPTS": "${WISEMAPPING_JAVA_OPTS:-Xmx1024m -Xms512m}",
                "SPRING_DATASOURCE_URL": "jdbc:postgresql://wisemapping-db:5432/wisemapping",
                "SPRING_DATASOURCE_USERNAME": "wisemapping",
                "SPRING_DATASOURCE_PASSWORD": "${WISEMAPPING_DB_PASSWORD}",
                "SPRING_DATASOURCE_DRIVER_CLASS_NAME": "org.postgresql.Driver",
                "SPRING_JPA_HIBERNATE_DDL_AUTO": "validate",
                "SPRING_JPA_PROPERTIES_HIBERNATE_DIALECT": "org.hibernate.dialect.PostgreSQLDialect"
            },
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/data",
                    "containerPath": "/var/lib/wisemapping"
                }
            ],
            "healthCheck": {
                "test": "curl -f http://localhost/health || exit 1",
                "interval": "30s",
                "timeout": "10s",
                "retries": 3,
                "startPeriod": "60s"
            },
            "dependsOn": [
                "wisemapping-db"
            ]
        },
        {
            "name": "wisemapping-db",
            "image": "postgres:16-alpine",
            "internalPort": 5432,
            "environment": {
                "POSTGRES_DB": "wisemapping",
                "POSTGRES_USER": "wisemapping",
                "POSTGRES_PASSWORD": "${WISEMAPPING_DB_PASSWORD}"
            },
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/data/postgres",
                    "containerPath": "/var/lib/postgresql/data"
                }
            ]
        }
    ]
}