{
    "schemaVersion": 2,
    "services": [
        {
            "name": "keycloak",
            "image": "quay.io/keycloak/keycloak:26.5.1",
            "isMain": true,
            "internalPort": 8080,
            "command": [
                "start"
            ],
            "environment": [
                {
                    "key": "KC_DB",
                    "value": "postgres"
                },
                {
                    "key": "KC_DB_URL",
                    "value": "jdbc:postgresql://keycloak-db:5432/"
                },
                {
                    "key": "KC_DB_USERNAME",
                    "value": "${KEYCLOAK_DB_USERNAME:-keycloak}"
                },
                {
                    "key": "KC_DB_PASSWORD",
                    "value": "${KEYCLOAK_DB_PASSWORD}"
                },
                {
                    "key": "KC_BOOTSTRAP_ADMIN_USERNAME",
                    "value": "${KEYCLOAK_ADMIN_USERNAME:-admin}"
                },
                {
                    "key": "KC_BOOTSTRAP_ADMIN_PASSWORD",
                    "value": "${KEYCLOAK_ADMIN_PASSWORD}"
                },
                {
                    "key": "KC_HOSTNAME",
                    "value": "${KEYCLOAK_HOSTNAME}"
                },
                {
                    "key": "KC_HTTP_ENABLED",
                    "value": "${KEYCLOAK_HTTP_ENABLED:-true}"
                },
                {
                    "key": "KC_PROXY_HEADERS",
                    "value": "${KEYCLOAK_PROXY_HEADERS:-xforwarded}"
                },
                {
                    "key": "KC_PROXY",
                    "value": "${KEYCLOAK_PROXY}"
                },
                {
                    "key": "KC_HOSTNAME_STRICT_HTTPS",
                    "value": "${KEYCLOAK_HOSTNAME_STRICT_HTTPS}"
                },
                {
                    "key": "KC_HOSTNAME_STRICT",
                    "value": "${KEYCLOAK_HOSTNAME_STRICT}"
                },
                {
                    "key": "TZ",
                    "value": "${TZ:-UTC}"
                }
            ],
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/data",
                    "containerPath": "/opt/keycloak/data",
                    "readOnly": false,
                    "shared": false,
                    "private": false
                }
            ]
        },
        {
            "name": "keycloak-db",
            "image": "postgres:16-alpine",
            "environment": [
                {
                    "key": "POSTGRES_DB",
                    "value": "${KEYCLOAK_DB_NAME:-keycloak}"
                },
                {
                    "key": "POSTGRES_USER",
                    "value": "${KEYCLOAK_DB_USERNAME:-keycloak}"
                },
                {
                    "key": "POSTGRES_PASSWORD",
                    "value": "${KEYCLOAK_DB_PASSWORD}"
                }
            ],
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/data/postgres",
                    "containerPath": "/var/lib/postgresql/data",
                    "readOnly": false,
                    "shared": false,
                    "private": false
                }
            ]
        }
    ]
}